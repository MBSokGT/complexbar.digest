<!DOCTYPE html>
<html>
<head>
    <title>–ù–∞–≥—Ä—É–∑–æ—á–Ω—ã–π —Ç–µ—Å—Ç</title>
    <style>
        body { font-family: Arial; padding: 20px; }
        button { padding: 10px 20px; margin: 5px; font-size: 16px; }
        #status { margin-top: 20px; }
    </style>
</head>
<body>
    <h1>üî• –ù–∞–≥—Ä—É–∑–æ—á–Ω—ã–π —Ç–µ—Å—Ç Firebase</h1>
    <button onclick="simulateUsers(10)">10 –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π</button>
    <button onclick="simulateUsers(50)">50 –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π</button>
    <button onclick="simulateUsers(100)">100 –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π</button>
    <button onclick="simulateUsers(200)">200 –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π</button>
    <button onclick="stopTest()">–û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å</button>
    <div id="status"></div>

    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-database-compat.js"></script>
    <script>
        const firebaseConfig = {
          apiKey: "AIzaSyAH_JmUT3QtUAJ04x8QIU12gYSMgyAfuqM",
          databaseURL: "https://digestcb-default-rtdb.firebaseio.com",
          projectId: "digestcb"
        };
        
        firebase.initializeApp(firebaseConfig);
        const db = firebase.database();
        let connections = [];
        
        function simulateUsers(count) {
            stopTest();
            document.getElementById('status').innerHTML = `–ó–∞–ø—É—Å–∫ ${count} –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π...<br>`;
            
            for (let i = 0; i < count; i++) {
                setTimeout(() => {
                    const userId = 'test_user_' + i;
                    const ref = db.ref('likes/card-0');
                    
                    ref.on('value', (snapshot) => {
                        // –°–∏–º—É–ª—è—Ü–∏—è —á—Ç–µ–Ω–∏—è
                    });
                    
                    connections.push(ref);
                    
                    // –°–∏–º—É–ª—è—Ü–∏—è –ª–∞–π–∫–∞
                    if (Math.random() > 0.5) {
                        ref.transaction((current) => (current || 0) + 1);
                    }
                    
                    document.getElementById('status').innerHTML += 
                        `‚úÖ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å ${i + 1}/${count} –ø–æ–¥–∫–ª—é—á–µ–Ω<br>`;
                }, i * 100);
            }
            
            setTimeout(() => {
                document.getElementById('status').innerHTML += 
                    `<br><strong>‚úÖ –¢–µ—Å—Ç –∑–∞–≤–µ—Ä—à—ë–Ω! ${count} –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∞–∫—Ç–∏–≤–Ω—ã.</strong>`;
            }, count * 100 + 1000);
        }
        
        function stopTest() {
            connections.forEach(ref => ref.off());
            connections = [];
            document.getElementById('status').innerHTML = '‚èπ –¢–µ—Å—Ç –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω<br>';
        }
    </script>
</body>
</html>
